<!doctype html>
<html lang="id">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Simulasi PLTA - Penerapan Rangkaian Listrik pada Kearifan Lokal Sungai</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="./assets/images/Logo.png" type="image/x-icon">

    <link rel="manifest" href="/edulab/manifest.json">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Edulab">
    <link rel="apple-touch-icon" href="/assets/images/Logo.png">

    <style>
        /* Reset & base */
        :root {
            --primary-purple: #667eea;
            --secondary-purple: #764ba2;
            --accent-blue: #1565c0;
            --text-dark: #2c3e50;
            --text-muted: #666;
            --glass-bg: rgba(255, 255, 255, 0.95);
            --glass-border: rgba(102, 126, 234, 0.1);
            --bg1: #b7e0d9;
            --bg2: #9dd7ff;
            --accent: #ffb74d;
            --card: #ffffff;
            --shadow: rgba(0, 0, 0, 0.08);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html,
        body {
            height: 100%;
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--text-dark);
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 118, 117, 0.15) 0%, transparent 50%);
            z-index: -1;
        }

        .app {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 14px;
            padding: 12px;
            min-height: 100vh;
            height: auto;
        }

        @media (max-width:900px) {
            .app {
                grid-template-columns: 1fr;
                grid-template-rows: 1fr auto;
                padding: 8px;
            }

            .workspace {
                order: 1;
            }

            aside.right {
                order: 2;
            }
        }

        button {
            background-color: #f0f0f0;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            border-radius: 4px;
        }

        button:hover {
            background-color: #e0e0e0;
        }

        #selesaiBtn {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        #selesaiBtn:hover {
            background: linear-gradient(135deg, #059669, #047857);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        .panel {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--glass-border);
            min-height: 80px;
            height: fit-content;
            align-self: start;
        }

        .panel h3 {
            margin: 0 0 1rem 0;
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-dark);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .workspace {
            position: relative;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            height: 95vh;
            overflow-y: auto;
        }

        .lab-area {
            width: 100%;
            height: 100%;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid var(--glass-border);
            padding: 18px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        @media (max-width:900px) {
            .lab-area {
                height: 100%;
                min-height: 400px;
            }
        }

        .bench {
            flex: 0 0 50%;
            position: relative;
            border-radius: 12px;
            padding: 12px;
            overflow: hidden;
            min-height: 400px;
            border: 1px solid var(--glass-border);
            z-index: 1;
        }

        .bench::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            filter: blur(3px);
            z-index: -1;
            transform: scale(1.1);
        }

        @media (max-width:900px) {
            .bench {
                height: 100%;
                min-height: 400px;
            }
        }

        .lab-pretest {
            flex: 0 0 40%;
            background: rgba(102, 126, 234, 0.05);
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            padding: 16px;
            overflow-y: auto;
            min-height: auto;
        }

        .lab-pretest-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 2px dashed rgba(102, 126, 234, 0.3);
        }

        .lab-pretest-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--primary-purple);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .lab-pretest-badge {
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple));
            color: white;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 11px;
            font-weight: 700;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .lab-question-card {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(102, 126, 234, 0.2);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 12px;
            display: flex;
            gap: 12px;
        }

        .lab-question-image {
            flex: 0 0 20%;
            min-width: 80px;
            max-width: 150px;
            border-radius: 8px;
            overflow: hidden;
            background: rgba(102, 126, 234, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .lab-question-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
        }

        .lab-question-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .lab-question-text {
            color: var(--text-dark);
            font-size: 13px;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .lab-question-context {
            background: rgba(96, 165, 250, 0.1);
            padding: 10px;
            border-radius: 8px;
            border-left: 3px solid #60a5fa;
            font-size: 12px;
            line-height: 1.5;
            color: var(--text-dark);
            margin-top: 8px;
        }

        .lab-pretest::-webkit-scrollbar {
            width: 6px;
        }

        .lab-pretest::-webkit-scrollbar-track {
            background: rgba(102, 126, 234, 0.05);
            border-radius: 3px;
        }

        .lab-pretest::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple));
            border-radius: 3px;
        }

        @media (max-width:900px) {
            .lab-question-card {
                flex-direction: column;
            }

            .lab-question-image {
                flex: 0 0 auto;
                width: 100%;
                max-width: 100%;
                height: 150px;
            }

            .lab-area {
                flex-direction: column;
            }

            .bench {
                flex: 0 0 60%;
                min-height: 350px;
            }

            .lab-pretest {
                flex: 0 0 30%;
                min-height: 200px;
            }

            .lab-question-text {
                font-size: 12px;
            }

            .lab-question-context {
                font-size: 11px;
            }
        }

        /* Scene styling */
        .scene {
            position: relative;
            width: 100%;
            height: 100%;
            min-height: 420px;
        }

        .sky {
            height: 140px;
            border-radius: 8px;
            background: linear-gradient(180deg, #cdefff 0%, #8fd0ff 70%);
            box-shadow: inset 0 -20px 40px rgba(0, 0, 0, 0.03);
        }

        #sungai {
            position: relative;
            margin-top: -30px;
            height: 220px;
            border-radius: 10px;
            overflow: hidden;
            background: linear-gradient(180deg, #4db6f5 0%, #0288d1 60%);
            box-shadow: inset 0 -10px 40px rgba(0, 0, 0, 0.12)
        }

        #sungai::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image: repeating-linear-gradient(-60deg, rgba(255, 255, 255, 0.12) 0 10px, rgba(255, 255, 255, 0.02) 10px 20px);
            opacity: 0.8;
            animation: flow 12s linear infinite;
            background-size: 200% 200%;
            animation: flow var(--flow-duration, 12s) linear infinite;
        }

        @keyframes flow {
            from {
                background-position: 0 0
            }

            to {
                background-position: 200% 0
            }
        }

        .bank {
            position: absolute;
            left: 2%;
            bottom: 25%;
            display: flex;
            gap: 8px;
            align-items: flex-end
        }

        .turbinWrap {
            width: clamp(100px, 15vw, 160px);
            height: clamp(100px, 15vw, 160px);
            background: linear-gradient(180deg, #6d4c41, #4e342e);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12)
        }

        #turbin {
            width: 75%;
            height: 75%;
            position: relative
        }

        .blade {
            position: absolute;
            left: 50%;
            top: 50%;
            width: 8px;
            height: 60px;
            background: linear-gradient(180deg, #ffd54f, #ffb74d);
            border-radius: 6px;
            transform-origin: 50% 80%
        }

        .blade.b1 {
            transform: translate(-50%, -80%) rotate(0deg)
        }

        .blade.b2 {
            transform: translate(-50%, -80%) rotate(90deg)
        }

        .blade.b3 {
            transform: translate(-50%, -80%) rotate(180deg)
        }

        .blade.b4 {
            transform: translate(-50%, -80%) rotate(270deg)
        }

        .generator {
            position: absolute;
            left: 25%;
            bottom: 50%;
            width: clamp(90px, 12vw, 120px);
            height: clamp(50px, 8vw, 70px);
            background: linear-gradient(180deg, #eceff1, #cfd8dc);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
            font-size: clamp(10px, 1.2vw, 12px);
            font-weight: 600;
            color: #424242;
        }

        .cable {
            position: absolute;
            height: 6px;
            background: #333;
            border-radius: 6px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15)
        }

        .cable.genToLamp {
            left: 38%;
            bottom: 57%;
            width: 50%;
            height: 4px;
        }

        .lampWrap {
            position: absolute;
            right: 5%;
            bottom: 30%;
            display: flex;
            flex-direction: column;
            align-items: center
        }

        #lamp {
            width: clamp(60px, 8vw, 80px);
            height: clamp(90px, 12vw, 120px);
            border-radius: 50px 50px 8px 8px;
            background: linear-gradient(180deg, #fff9c4, #fff176);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.12);
            transition: filter 0.2s, box-shadow 0.2s;
            font-size: clamp(24px, 4vw, 32px);
        }

        .lampOff {
            filter: grayscale(1) brightness(0.6);
            opacity: 0.4
        }

        .lampGlow {
            position: absolute;
            width: 160px;
            height: 160px;
            border-radius: 50%;
            filter: blur(18px);
            opacity: 0;
            transition: opacity 0.2s
        }

        #saklar {
            position: relative;
            padding: 10px 16px;
            border-radius: 10px;
            background: linear-gradient(180deg, #ffffff, #f1f1f1);
            cursor: pointer;
            border: 1px solid rgba(0, 0, 0, 0.06);
            display: inline-flex;
            align-items: center;
            gap: 10px
        }

        #saklar .dot {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #bdbdbd;
            transition: all 0.18s
        }

        #saklar.on .dot {
            background: #4caf50;
            transform: translateX(4px)
        }

        .right {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: calc(100vh - 24px);
            overflow-y: auto;
        }

        .right::-webkit-scrollbar {
            width: 6px;
        }

        .right::-webkit-scrollbar-track {
            background: rgba(102, 126, 234, 0.05);
            border-radius: 3px;
        }

        .right::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple));
            border-radius: 3px;
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 12px
        }

        .values {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }

        .value {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            background: linear-gradient(180deg, #fff, #f7f7f7);
            text-align: center;
            min-width: 80px;
        }

        .value strong {
            display: block;
            font-size: 18px
        }

        .label {
            font-size: 12px;
            color: #555
        }

        .rangeRow {
            display: flex;
            align-items: center;
            gap: 12px
        }

        input[type=range] {
            -webkit-appearance: none;
            width: 100%
        }

        input[type=range]::-webkit-slider-runnable-track {
            height: 6px;
            background: linear-gradient(90deg, #81d4fa, #0288d1);
            border-radius: 6px
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #fff;
            border: 4px solid #0288d1;
            border-radius: 50%;
            margin-top: -6px
        }

        .note {
            font-size: 13px;
            color: #444;
            line-height: 1.6;
        }

        strong {
            color: var(--primary-purple);
            font-weight: 700;
        }

        .btn {
            display: inline-block;
            padding: 8px 12px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple));
            color: white;
            font-weight: 700;
            font-family: 'Montserrat', sans-serif;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25);
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.95), rgba(118, 75, 162, 0.95));
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loader p {
            margin-top: 1rem;
            font-size: 1.2rem;
            color: white;
            font-weight: 700;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .post-test-popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            z-index: 10000;
            overflow-y: auto;
            padding: 20px;
        }

        .post-test-popup.active {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }

        .post-test-content {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            border: 1px solid var(--glass-border);
            animation: slideUp 0.4s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .post-test-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 28px;
            border-bottom: 2px solid rgba(102, 126, 234, 0.2);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }

        .post-test-header h2 {
            margin: 0;
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-purple);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .close-btn {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
        }

        .close-btn:hover {
            background: rgba(239, 68, 68, 0.2);
            transform: rotate(90deg);
        }

        .post-test-body {
            padding: 24px 28px;
            overflow-y: auto;
            max-height: calc(90vh - 180px);
        }

        .post-test-body::-webkit-scrollbar {
            width: 8px;
        }

        .post-test-body::-webkit-scrollbar-track {
            background: rgba(102, 126, 234, 0.05);
            border-radius: 4px;
        }

        .post-test-body::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple));
            border-radius: 4px;
        }

        .test-intro {
            background: rgba(96, 165, 250, 0.1);
            padding: 16px;
            border-radius: 12px;
            border-left: 4px solid #60a5fa;
            margin-bottom: 24px;
        }

        .question-card {
            background: rgba(255, 255, 255, 0.6);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .question-card:hover {
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.15);
            transform: translateY(-2px);
        }

        .question-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .question-number {
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple));
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .question-tag {
            background: rgba(102, 126, 234, 0.1);
            color: var(--primary-purple);
            padding: 6px 14px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 13px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .question-context {
            background: rgba(255, 255, 255, 0.8);
            padding: 14px;
            border-radius: 8px;
            margin-bottom: 14px;
            line-height: 1.6;
            color: var(--text-dark);
            font-size: 14px;
            border-left: 3px solid rgba(102, 126, 234, 0.5);
        }

        .question-text {
            color: var(--text-dark);
            line-height: 1.7;
            font-size: 14px;
        }

        .question-text p {
            margin-bottom: 10px;
        }

        .question-text ol {
            margin-left: 20px;
            margin-top: 8px;
            line-height: 1.8;
        }

        .question-text ol li {
            margin-bottom: 10px;
            padding-left: 8px;
        }

        .post-test-footer {
            padding: 20px 28px;
            border-top: 2px solid rgba(102, 126, 234, 0.2);
            display: flex;
            justify-content: center;
            background: rgba(255, 255, 255, 0.5);
        }

        .close-test-btn {
            padding: 14px 40px;
            font-size: 16px;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple));
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .close-test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
        }

        @media (max-width: 900px) {
            .post-test-popup {
                padding: 10px;
            }

            .post-test-content {
                max-height: 95vh;
            }

            .post-test-header {
                padding: 16px 20px;
            }

            .post-test-header h2 {
                font-size: 18px;
            }

            .post-test-body {
                padding: 16px 20px;
                max-height: calc(95vh - 160px);
            }

            .question-card {
                padding: 16px;
            }

            .question-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .question-text ol {
                margin-left: 16px;
            }
        }

        @media (max-width:768px) and (min-width:421px) {
            .bank {
                left: 2%;
                bottom: 22%;
            }

            .turbinWrap {
                width: 130px;
                height: 130px;
            }

            .generator {
                left: 24%;
                bottom: 50%;
                width: 100px;
                height: 60px;
                font-size: 11px;
            }

            .cable.genToLamp {
                left: 35%;
                bottom: 56%;
                width: 30%;
            }

            .lampWrap {
                right: 4%;
                bottom: 50%;
            }
        }
    </style>
</head>

<body>
    <div class="loader">
        <div class="spinner"></div>
        <p>Loading...</p>
    </div>

    <div class="app">
        <main class="panel workspace">
            <div class="lab-area">
                <div class="bench">
                    <div class="scene">
                        <div class="sky"></div>
                        <div id="sungai" aria-hidden="true">
                            <div class="bank">
                                <div class="turbinWrap" aria-hidden="true">
                                    <div id="turbin" aria-label="Turbin (kincir air)">
                                        <div class="blade b1"></div>
                                        <div class="blade b2"></div>
                                        <div class="blade b3"></div>
                                        <div class="blade b4"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="generator" id="generator" aria-label="Generator">Generator</div>
                            <div class="cable genToLamp" aria-hidden="true"></div>

                            <div class="lampWrap">
                                <div id="lamp" class="lampOff" aria-live="polite" aria-label="Lampu">
                                    <div style="font-weight:700">üí°</div>
                                </div>
                                <div id="glow" class="lampGlow"></div>
                            </div>
                        </div>

                        <div style="padding:12px;display:flex;gap:10px;align-items:center;justify-content:flex-start">
                            <div style="flex:1">
                                <h2 style="margin:6px 0 0 0">PLTA - Energi Air Lokal ‚Üí Energi Listrik</h2>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="lab-pretest">
                    <div class="lab-pretest-header">
                        <div class="lab-pretest-title">
                            üìù Studi Kasus
                        </div>
                        <span class="lab-pretest-badge">Rangkaian Listrik</span>
                    </div>

                    <div class="lab-question-card">
                        <div class="lab-question-image">
                            <img src="./assets/images/sungai-deras.jpg" alt="Ilustrasi PLTA"
                                onerror="this.style.display='none'">
                        </div>

                        <div class="lab-question-content">
                            <div class="lab-question-text">
                                <strong>Pertanyaan:</strong><br>
                                Sebuah desa di pegunungan memiliki sungai dengan debit air yang cukup deras. Warga ingin
                                memanfaatkan aliran sungai tersebut untuk membangkitkan listrik sederhana (PLTA mikro).
                                Bagaimana hubungan antara debit air dengan tegangan dan arus listrik yang dihasilkan?
                                Jelaskan dengan konsep hukum Ohm!
                            </div>

                            <div class="lab-question-context">
                                üí° <strong>Petunjuk:</strong> Pikirkan tentang bagaimana energi kinetik air diubah
                                menjadi energi listrik melalui turbin dan generator. Pertimbangkan hubungan V
                                (tegangan),
                                I (arus), dan R (hambatan) dalam rangkaian.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <aside class="panel right">
            <button onclick="window.location.href='./start-praktikum.html'">Kembali</button>
            <button id="selesaiBtn">Selesai</button>

            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px">
                <h3 style="margin:0">üìä Kontrol</h3>
            </div>

            <div
                style="background: rgba(102, 126, 234, 0.05); padding: 12px; border-radius: 10px; border: 1px solid var(--glass-border); margin-bottom: 12px;">
                <div class="controls">
                    <div class="rangeRow">
                        <label for="debit" style="font-weight: 600;">Debit Air Lokal</label>
                        <input id="debit" type="range" min="0" max="100" value="50" aria-label="Debit Air Lokal" />
                        <div id="debitVal" style="width:44px;text-align:right;font-weight:600;">50</div>
                    </div>

                    <div style="display:flex;gap:10px;align-items:center">
                        <div id="saklar" role="button" tabindex="0" aria-pressed="false" class=""
                            title="Klik untuk menyalakan atau mematikan">
                            <div class="dot"></div>
                            <div style="font-size:13px;font-weight:600;">Saklar</div>
                        </div>
                        <div style="font-size:12px;color:#666">(Rangkaian: Terbuka / Tertutup)</div>
                    </div>
                </div>
            </div>

            <div id="panelKontrol" aria-live="polite"
                style="display:none; background: rgba(102, 126, 234, 0.05); padding: 12px; border-radius: 10px; border: 1px solid var(--glass-border); margin-bottom: 12px;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px;">‚ö° Panel Kontrol</h3>
                <div class="values">
                    <div class="value"><strong id="volt">-- V</strong><span class="label">Tegangan (Volt)</span></div>
                    <div class="value"><strong id="ampere">-- A</strong><span class="label">Arus (Ampere)</span></div>
                    <div class="value"><strong id="ohm">-- Œ©</strong><span class="label">Hambatan (Ohm)</span></div>
                </div>
            </div>

            <div style="margin-top:10px">
                <strong>üìñ Penjelasan Singkat</strong>
                <p class="note"
                    style="margin-top: 8px; background: rgba(102, 126, 234, 0.05); padding: 12px; border-radius: 8px; border: 1px solid var(--glass-border);">
                    Ketika debit air meningkat (kearifan lokal: memanfaatkan aliran sungai), turbin berputar lebih cepat
                    ‚Üí generator menghasilkan tegangan lebih besar. Dengan hambatan lampu yang relatif tetap, arus
                    meningkat sesuai hukum Ohm: <em>I = V / R</em>.
                </p>
            </div>

            <div style="margin-top:10px">
                <strong>üìã Instruksi</strong>
                <ol style="margin:8px 0 0 0;padding-left:18px;font-size:13px;line-height:1.7;">
                    <li>Atur <strong>Debit Air Lokal</strong> menggunakan slider.</li>
                    <li>Tekan <strong>Saklar</strong> untuk menutup rangkaian dan menyalakan lampu.</li>
                    <li>Perhatikan perubahan Tegangan, Arus, dan kecerahan lampu.</li>
                </ol>
            </div>
        </aside>

        <div id="postTestPopup" class="post-test-popup">
            <div class="post-test-content">
                <div class="post-test-header">
                    <h2>üìã Post Test - Evaluasi Praktikum</h2>
                    <button id="closePostTest" class="close-btn">‚úï</button>
                </div>

                <div class="post-test-body">
                    <div class="test-intro">
                        <p style="margin-bottom: 16px; color: var(--text-muted); line-height: 1.6;">
                            Selamat! Anda telah menyelesaikan praktikum virtual rangkaian listrik PLTA. Berikut adalah 5
                            soal analisis untuk menguji pemahaman Anda tentang konsep rangkaian listrik dan hukum Ohm.
                        </p>
                    </div>

                    <!-- Soal 1 -->
                    <div class="question-card">
                        <div class="question-header">
                            <span class="question-number">Soal 1</span>
                            <span class="question-tag">Hukum Ohm dalam PLTA</span>
                        </div>
                        <div class="question-context">
                            Dalam simulasi PLTA, ketika debit air ditingkatkan dari 50 menjadi 100, tegangan yang
                            dihasilkan meningkat dari 220V menjadi 440V, sementara hambatan lampu tetap 440Œ©.
                        </div>
                        <div class="question-text">
                            <p><strong>Pertanyaan:</strong></p>
                            <ol>
                                <li>Hitung arus listrik yang mengalir pada kedua kondisi tersebut menggunakan hukum Ohm!
                                </li>
                                <li>Jelaskan bagaimana peningkatan debit air mempengaruhi daya listrik (P = V √ó I) yang
                                    dihasilkan!</li>
                            </ol>
                        </div>
                    </div>

                    <!-- Soal 2 -->
                    <div class="question-card">
                        <div class="question-header">
                            <span class="question-number">Soal 2</span>
                            <span class="question-tag">Konversi Energi dalam PLTA</span>
                        </div>
                        <div class="question-context">
                            PLTA mengubah energi kinetik air menjadi energi listrik melalui turbin dan generator. Proses
                            ini melibatkan beberapa tahapan konversi energi.
                        </div>
                        <div class="question-text">
                            <p><strong>Pertanyaan:</strong></p>
                            <ol>
                                <li>Jelaskan secara runtut proses konversi energi yang terjadi dalam PLTA, dari energi
                                    potensial air hingga menjadi energi listrik!</li>
                                <li>Mengapa tidak semua energi air dapat dikonversi menjadi energi listrik? Sebutkan
                                    faktor-faktor yang menyebabkan kehilangan energi!</li>
                            </ol>
                        </div>
                    </div>

                    <!-- Soal 3 -->
                    <div class="question-card">
                        <div class="question-header">
                            <span class="question-number">Soal 3</span>
                            <span class="question-tag">Rangkaian Seri dan Paralel</span>
                        </div>
                        <div class="question-context">
                            Sebuah desa ingin menambahkan 3 lampu tambahan pada sistem PLTA yang sudah ada. Mereka
                            mempertimbangkan apakah lampu-lampu tersebut akan dipasang secara seri atau paralel.
                        </div>
                        <div class="question-text">
                            <p><strong>Pertanyaan:</strong></p>
                            <ol>
                                <li>Jelaskan perbedaan antara rangkaian seri dan paralel dalam hal pembagian tegangan
                                    dan
                                    arus!</li>
                                <li>Untuk kondisi desa tersebut, susunan mana yang lebih menguntungkan (seri atau
                                    paralel)? Berikan alasan berdasarkan prinsip rangkaian listrik!</li>
                            </ol>
                        </div>
                    </div>

                    <!-- Soal 4 -->
                    <div class="question-card">
                        <div class="question-header">
                            <span class="question-number">Soal 4</span>
                            <span class="question-tag">Efisiensi dan Optimasi PLTA</span>
                        </div>
                        <div class="question-context">
                            Dalam praktik, PLTA mikro desa memiliki efisiensi sekitar 60-70%, artinya tidak semua energi
                            air dapat diubah menjadi energi listrik yang dapat dimanfaatkan.
                        </div>
                        <div class="question-text">
                            <p><strong>Pertanyaan:</strong></p>
                            <ol>
                                <li>Jika debit air 100 liter/detik dengan ketinggian jatuh 10 meter menghasilkan energi
                                    potensial sebesar 9.800 Joule/detik, berapa daya listrik yang dihasilkan jika
                                    efisiensi sistem 65%?</li>
                                <li>Apa saja cara yang dapat dilakukan untuk meningkatkan efisiensi PLTA mikro tersebut?
                                </li>
                            </ol>
                        </div>
                    </div>

                    <!-- Soal 5 -->
                    <div class="question-card">
                        <div class="question-header">
                            <span class="question-number">Soal 5</span>
                            <span class="question-tag">Kearifan Lokal dan Keberlanjutan</span>
                        </div>
                        <div class="question-context">
                            Pemanfaatan PLTA mikro merupakan bentuk kearifan lokal dalam memanfaatkan sumber daya alam
                            terbarukan. Namun, tetap harus memperhatikan dampak lingkungan dan keberlanjutan.
                        </div>
                        <div class="question-text">
                            <p><strong>Pertanyaan:</strong></p>
                            <ol>
                                <li>Analisis kelebihan dan kekurangan PLTA mikro sebagai sumber energi alternatif untuk
                                    desa terpencil!</li>
                                <li>Bagaimana cara mengelola PLTA mikro agar tetap berkelanjutan dan tidak merusak
                                    ekosistem sungai? Berikan minimal 3 saran konkret!</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <div class="post-test-footer">
                    <button id="closePostTestBtn" class="btn close-test-btn">
                        ‚úì Selesai Membaca
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const debit = document.getElementById('debit');
        const debitVal = document.getElementById('debitVal');
        const saklar = document.getElementById('saklar');
        const panelKontrol = document.getElementById('panelKontrol');
        const voltEl = document.getElementById('volt');
        const ampEl = document.getElementById('ampere');
        const ohmEl = document.getElementById('ohm');
        const lamp = document.getElementById('lamp');
        const glow = document.getElementById('glow');
        const turbin = document.getElementById('turbin');
        const postTestPopup = document.getElementById('postTestPopup');
        const selesaiBtn = document.getElementById('selesaiBtn');
        const closePostTest = document.getElementById('closePostTest');
        const closePostTestBtn = document.getElementById('closePostTestBtn');

        const V0 = 220;
        const Rlamp = 440;
        const baseSlider = 50;

        let isOn = false;

        function updateFromSlider() {
            const s = Number(debit.value);
            debitVal.textContent = s;

            const multiplier = s / baseSlider;
            const V = +(V0 * multiplier).toFixed(1);

            const I = +((Rlamp === 0) ? 0 : (V / Rlamp)).toFixed(3);
            const R = Rlamp;

            const speed = Math.max(0.1, multiplier);

            if (isOn) {
                voltEl.textContent = V + ' V';
                ampEl.textContent = I + ' A';
                ohmEl.textContent = R + ' Œ©';

                const brightness = Math.min(3, 0.5 + (I * 3));
                lamp.classList.remove('lampOff');
                lamp.style.filter = `brightness(${brightness})`;
                lamp.style.boxShadow = `0 8px 30px rgba(255,200,50,${Math.min(0.6, I * 1.8)})`;
                glow.style.background = 'radial-gradient(circle at center, rgba(255,235,59,0.8), rgba(255,193,7,0.2), transparent)';
                glow.style.opacity = Math.min(0.9, I * 1.6);
            } else {
                voltEl.textContent = '-- V';
                ampEl.textContent = '-- A';
                ohmEl.textContent = '-- Œ©';
                lamp.classList.add('lampOff');
                lamp.style.filter = '';
                lamp.style.boxShadow = '';
                glow.style.opacity = 0;
            }

            currentSpeed = speed;
        }

        function toggleSaklar() {
            isOn = !isOn;
            saklar.setAttribute('aria-pressed', String(isOn));
            if (isOn) {
                saklar.classList.add('on');
                panelKontrol.style.display = 'block';
            } else {
                saklar.classList.remove('on');
                panelKontrol.style.display = 'none';
            }
            updateFromSlider();
        }

        saklar.addEventListener('click', toggleSaklar);
        saklar.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleSaklar(); } });

        debit.addEventListener('input', () => {
            updateFromSlider();
        });

        let currentAngle = 0;
        let currentSpeed = 1;
        function rotateLoop() {
            const degreesPerFrame = 0.5 * currentSpeed;
            currentAngle = currentAngle + degreesPerFrame;
            turbin.style.transform = `rotate(${currentAngle}deg)`;
            requestAnimationFrame(rotateLoop);
        }
        rotateLoop();

        updateFromSlider();

        saklar.addEventListener('click', () => {
            if (isOn) saklar.setAttribute('title', 'Saklar: ON (Klik untuk mematikan)');
            else saklar.setAttribute('title', 'Saklar: OFF (Klik untuk menyalakan)');
        });

        const sungai = document.getElementById('sungai');
        function updateFlowSpeed() {
            const s = Number(debit.value);
            const flowDuration = 20 - (s / 100) * 15;
            sungai.style.setProperty('--flow-duration', flowDuration + 's');
        }
        debit.addEventListener('input', updateFlowSpeed);
        updateFlowSpeed();

        // Post Test functionality
        selesaiBtn.addEventListener('click', () => {
            postTestPopup.classList.add('active');
            document.body.style.overflow = 'hidden';
            flashMessage('üìã Silakan baca soal Post Test');
        });

        closePostTest.addEventListener('click', () => {
            postTestPopup.classList.remove('active');
            document.body.style.overflow = 'auto';
        });

        closePostTestBtn.addEventListener('click', () => {
            postTestPopup.classList.remove('active');
            document.body.style.overflow = 'auto';
            flashMessage('‚úì Terima kasih telah membaca Post Test');
        });

        postTestPopup.addEventListener('click', (e) => {
            if (e.target === postTestPopup) {
                postTestPopup.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && postTestPopup.classList.contains('active')) {
                postTestPopup.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        });

        function flashMessage(text) {
            const f = document.createElement('div');
            f.style.position = 'fixed';
            f.style.left = '50%';
            f.style.top = '20%';
            f.style.transform = 'translateX(-50%) scale(0.8)';
            f.style.background = 'var(--glass-bg)';
            f.style.color = 'var(--text-dark)';
            f.style.backdropFilter = 'blur(10px)';
            f.style.padding = '16px 24px';
            f.style.borderRadius = '12px';
            f.style.zIndex = '9999';
            f.style.fontSize = '16px';
            f.style.fontWeight = '600';
            f.style.boxShadow = '0 8px 32px rgba(0,0,0,0.5)';
            f.style.border = '1px solid rgba(255,255,255,0.1)';
            f.style.transition = 'all 0.3s ease-out';
            f.innerText = text;
            document.body.appendChild(f);

            setTimeout(() => f.style.transform = 'translateX(-50%) scale(1)', 10);
            setTimeout(() => {
                f.style.opacity = '0';
                f.style.transform = 'translateX(-50%) scale(0.8)';
            }, 1500);
            setTimeout(() => f.remove(), 1800);
        }

        // Hide preloader
        window.addEventListener('load', () => {
            const loader = document.querySelector('.loader');
            if (loader) loader.style.display = 'none';
            flashMessage('‚ö° Virtual Lab siap digunakan!');
        });

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/edulab/service-worker.js', {
                    scope: '/edulab/'
                })
                    .then((registration) => {
                        console.log('Service Worker registered successfully:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>

</html>